{"ast":null,"code":"import * as React from 'react';\nimport { useLightboxProps, useMotionPreference, useEventCallback, useLayoutEffect, useLightboxState, isImageSlide, isImageFitCover, round, useDocumentContext, useController, usePointerEvents, cleanup, makeUseContext, createIcon, IconButton, devicePixelRatio, ImageSlide, clsx, cssClass, addToolbarButton, createModule } from '../../index.js';\nimport { EVENT_ON_KEY_DOWN, EVENT_ON_WHEEL, UNKNOWN_ACTION_TYPE, CLASS_FULLSIZE, CLASS_FLEX_CENTER, CLASS_SLIDE_WRAPPER, CLASS_SLIDE_WRAPPER_INTERACTIVE, PLUGIN_ZOOM } from '../../types.js';\nconst defaultZoomProps = {\n  maxZoomPixelRatio: 1,\n  zoomInMultiplier: 2,\n  doubleTapDelay: 300,\n  doubleClickDelay: 500,\n  doubleClickMaxStops: 2,\n  keyboardMoveDistance: 50,\n  wheelZoomDistanceFactor: 100,\n  pinchZoomDistanceFactor: 100,\n  scrollToZoom: false\n};\nconst resolveZoomProps = zoom => ({\n  ...defaultZoomProps,\n  ...zoom\n});\nfunction useZoomAnimation(zoom, offsetX, offsetY, zoomWrapperRef) {\n  const zoomAnimation = React.useRef(undefined);\n  const zoomAnimationStart = React.useRef(undefined);\n  const {\n    zoom: zoomAnimationDuration\n  } = useLightboxProps().animation;\n  const reduceMotion = useMotionPreference();\n  const playZoomAnimation = useEventCallback(() => {\n    var _a, _b, _c;\n    (_a = zoomAnimation.current) === null || _a === void 0 ? void 0 : _a.cancel();\n    zoomAnimation.current = undefined;\n    if (zoomAnimationStart.current && (zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current)) {\n      try {\n        zoomAnimation.current = (_c = (_b = zoomWrapperRef.current).animate) === null || _c === void 0 ? void 0 : _c.call(_b, [{\n          transform: zoomAnimationStart.current\n        }, {\n          transform: `scale(${zoom}) translateX(${offsetX}px) translateY(${offsetY}px)`\n        }], {\n          duration: !reduceMotion ? zoomAnimationDuration !== null && zoomAnimationDuration !== void 0 ? zoomAnimationDuration : 500 : 0,\n          easing: zoomAnimation.current ? \"ease-out\" : \"ease-in-out\"\n        });\n      } catch (err) {\n        console.error(err);\n      }\n      zoomAnimationStart.current = undefined;\n      if (zoomAnimation.current) {\n        zoomAnimation.current.onfinish = () => {\n          zoomAnimation.current = undefined;\n        };\n      }\n    }\n  });\n  useLayoutEffect(playZoomAnimation, [zoom, offsetX, offsetY, playZoomAnimation]);\n  return React.useCallback(() => {\n    zoomAnimationStart.current = (zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current) ? window.getComputedStyle(zoomWrapperRef.current).transform : undefined;\n  }, [zoomWrapperRef]);\n}\nfunction useZoomCallback(zoom, disabled) {\n  const {\n    on\n  } = useLightboxProps();\n  const onZoomCallback = useEventCallback(() => {\n    var _a;\n    if (!disabled) {\n      (_a = on.zoom) === null || _a === void 0 ? void 0 : _a.call(on, {\n        zoom\n      });\n    }\n  });\n  React.useEffect(onZoomCallback, [zoom, onZoomCallback]);\n}\nfunction useZoomProps() {\n  const {\n    zoom\n  } = useLightboxProps();\n  return resolveZoomProps(zoom);\n}\nfunction useZoomImageRect(slideRect, imageDimensions) {\n  var _a, _b;\n  let imageRect = {\n    width: 0,\n    height: 0\n  };\n  let maxImageRect = {\n    width: 0,\n    height: 0\n  };\n  const {\n    currentSlide\n  } = useLightboxState();\n  const {\n    imageFit\n  } = useLightboxProps().carousel;\n  const {\n    maxZoomPixelRatio\n  } = useZoomProps();\n  if (slideRect && currentSlide) {\n    const slide = {\n      ...currentSlide,\n      ...imageDimensions\n    };\n    if (isImageSlide(slide)) {\n      const cover = isImageFitCover(slide, imageFit);\n      const width = Math.max(...(((_a = slide.srcSet) === null || _a === void 0 ? void 0 : _a.map(x => x.width)) || []).concat(slide.width ? [slide.width] : []));\n      const height = Math.max(...(((_b = slide.srcSet) === null || _b === void 0 ? void 0 : _b.map(x => x.height)) || []).concat(slide.height ? [slide.height] : []));\n      if (width > 0 && height > 0 && slideRect.width > 0 && slideRect.height > 0) {\n        maxImageRect = cover ? {\n          width: Math.round(Math.min(width, slideRect.width / slideRect.height * height)),\n          height: Math.round(Math.min(height, slideRect.height / slideRect.width * width))\n        } : {\n          width,\n          height\n        };\n        maxImageRect = {\n          width: maxImageRect.width * maxZoomPixelRatio,\n          height: maxImageRect.height * maxZoomPixelRatio\n        };\n        imageRect = cover ? {\n          width: Math.min(slideRect.width, maxImageRect.width, width),\n          height: Math.min(slideRect.height, maxImageRect.height, height)\n        } : {\n          width: Math.round(Math.min(slideRect.width, slideRect.height / height * width, width)),\n          height: Math.round(Math.min(slideRect.height, slideRect.width / width * height, height))\n        };\n      }\n    }\n  }\n  const maxZoom = imageRect.width ? Math.max(round(maxImageRect.width / imageRect.width, 5), 1) : 1;\n  return {\n    imageRect,\n    maxZoom\n  };\n}\nfunction distance(pointerA, pointerB) {\n  return ((pointerA.clientX - pointerB.clientX) ** 2 + (pointerA.clientY - pointerB.clientY) ** 2) ** 0.5;\n}\nfunction scaleZoom(value, delta) {\n  let factor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 100;\n  let clamp = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 2;\n  return value * Math.min(1 + Math.abs(delta / factor), clamp) ** Math.sign(delta);\n}\nfunction useZoomSensors(zoom, maxZoom, disabled, changeZoom, changeOffsets, zoomWrapperRef) {\n  const activePointers = React.useRef([]);\n  const lastPointerDown = React.useRef(0);\n  const pinchZoomDistance = React.useRef(undefined);\n  const {\n    globalIndex\n  } = useLightboxState();\n  const {\n    getOwnerWindow\n  } = useDocumentContext();\n  const {\n    containerRef,\n    subscribeSensors\n  } = useController();\n  const {\n    keyboardMoveDistance,\n    zoomInMultiplier,\n    wheelZoomDistanceFactor,\n    scrollToZoom,\n    doubleTapDelay,\n    doubleClickDelay,\n    doubleClickMaxStops,\n    pinchZoomDistanceFactor\n  } = useZoomProps();\n  const translateCoordinates = React.useCallback(event => {\n    if (containerRef.current) {\n      const {\n        pageX,\n        pageY\n      } = event;\n      const {\n        scrollX,\n        scrollY\n      } = getOwnerWindow();\n      const {\n        left,\n        top,\n        width,\n        height\n      } = containerRef.current.getBoundingClientRect();\n      return [pageX - left - scrollX - width / 2, pageY - top - scrollY - height / 2];\n    }\n    return [];\n  }, [containerRef, getOwnerWindow]);\n  const onKeyDown = useEventCallback(event => {\n    const {\n      key,\n      metaKey,\n      ctrlKey\n    } = event;\n    const meta = metaKey || ctrlKey;\n    const preventDefault = () => {\n      event.preventDefault();\n      event.stopPropagation();\n    };\n    if (zoom > 1) {\n      const move = (deltaX, deltaY) => {\n        preventDefault();\n        changeOffsets(deltaX, deltaY);\n      };\n      if (key === \"ArrowDown\") {\n        move(0, keyboardMoveDistance);\n      } else if (key === \"ArrowUp\") {\n        move(0, -keyboardMoveDistance);\n      } else if (key === \"ArrowLeft\") {\n        move(-keyboardMoveDistance, 0);\n      } else if (key === \"ArrowRight\") {\n        move(keyboardMoveDistance, 0);\n      }\n    }\n    const handleChangeZoom = zoomValue => {\n      preventDefault();\n      changeZoom(zoomValue);\n    };\n    if (key === \"+\" || meta && key === \"=\") {\n      handleChangeZoom(zoom * zoomInMultiplier);\n    } else if (key === \"-\" || meta && key === \"_\") {\n      handleChangeZoom(zoom / zoomInMultiplier);\n    } else if (meta && key === \"0\") {\n      handleChangeZoom(1);\n    }\n  });\n  const onWheel = useEventCallback(event => {\n    if (event.ctrlKey || scrollToZoom) {\n      if (Math.abs(event.deltaY) > Math.abs(event.deltaX)) {\n        event.stopPropagation();\n        changeZoom(scaleZoom(zoom, -event.deltaY, wheelZoomDistanceFactor), true, ...translateCoordinates(event));\n        return;\n      }\n    }\n    if (zoom > 1) {\n      event.stopPropagation();\n      if (!scrollToZoom) {\n        changeOffsets(event.deltaX, event.deltaY);\n      }\n    }\n  });\n  const clearPointer = React.useCallback(event => {\n    const pointers = activePointers.current;\n    pointers.splice(0, pointers.length, ...pointers.filter(p => p.pointerId !== event.pointerId));\n  }, []);\n  const replacePointer = React.useCallback(event => {\n    clearPointer(event);\n    event.persist();\n    activePointers.current.push(event);\n  }, [clearPointer]);\n  const onPointerDown = useEventCallback(event => {\n    var _a;\n    const pointers = activePointers.current;\n    if (event.pointerType === \"mouse\" && event.buttons > 1 || !((_a = zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target))) {\n      return;\n    }\n    if (zoom > 1) {\n      event.stopPropagation();\n    }\n    const {\n      timeStamp\n    } = event;\n    if (pointers.length === 0 && timeStamp - lastPointerDown.current < (event.pointerType === \"touch\" ? doubleTapDelay : doubleClickDelay)) {\n      lastPointerDown.current = 0;\n      changeZoom(zoom !== maxZoom ? zoom * Math.max(maxZoom ** (1 / doubleClickMaxStops), zoomInMultiplier) : 1, false, ...translateCoordinates(event));\n    } else {\n      lastPointerDown.current = timeStamp;\n    }\n    replacePointer(event);\n    if (pointers.length === 2) {\n      pinchZoomDistance.current = distance(pointers[0], pointers[1]);\n    }\n  });\n  const onPointerMove = useEventCallback(event => {\n    const pointers = activePointers.current;\n    const activePointer = pointers.find(p => p.pointerId === event.pointerId);\n    if (pointers.length === 2 && pinchZoomDistance.current) {\n      event.stopPropagation();\n      replacePointer(event);\n      const currentDistance = distance(pointers[0], pointers[1]);\n      const delta = currentDistance - pinchZoomDistance.current;\n      if (Math.abs(delta) > 0) {\n        changeZoom(scaleZoom(zoom, delta, pinchZoomDistanceFactor), true, ...pointers.map(x => translateCoordinates(x)).reduce((acc, coordinate) => coordinate.map((x, i) => acc[i] + x / 2)));\n        pinchZoomDistance.current = currentDistance;\n      }\n      return;\n    }\n    if (zoom > 1) {\n      event.stopPropagation();\n      if (activePointer) {\n        if (pointers.length === 1) {\n          changeOffsets((activePointer.clientX - event.clientX) / zoom, (activePointer.clientY - event.clientY) / zoom);\n        }\n        replacePointer(event);\n      }\n    }\n  });\n  const onPointerUp = React.useCallback(event => {\n    const pointers = activePointers.current;\n    if (pointers.length === 2 && pointers.find(p => p.pointerId === event.pointerId)) {\n      pinchZoomDistance.current = undefined;\n    }\n    clearPointer(event);\n  }, [clearPointer]);\n  const cleanupSensors = React.useCallback(() => {\n    const pointers = activePointers.current;\n    pointers.splice(0, pointers.length);\n    lastPointerDown.current = 0;\n    pinchZoomDistance.current = undefined;\n  }, []);\n  usePointerEvents(subscribeSensors, onPointerDown, onPointerMove, onPointerUp, disabled);\n  React.useEffect(cleanupSensors, [globalIndex, cleanupSensors]);\n  React.useEffect(() => {\n    if (!disabled) {\n      return cleanup(cleanupSensors, subscribeSensors(EVENT_ON_KEY_DOWN, onKeyDown), subscribeSensors(EVENT_ON_WHEEL, onWheel));\n    }\n    return () => {};\n  }, [disabled, subscribeSensors, cleanupSensors, onKeyDown, onWheel]);\n}\nfunction useZoomState(imageRect, maxZoom, zoomWrapperRef) {\n  const [zoom, setZoom] = React.useState(1);\n  const [offsetX, setOffsetX] = React.useState(0);\n  const [offsetY, setOffsetY] = React.useState(0);\n  const animate = useZoomAnimation(zoom, offsetX, offsetY, zoomWrapperRef);\n  const {\n    currentSlide,\n    globalIndex\n  } = useLightboxState();\n  const {\n    containerRect,\n    slideRect\n  } = useController();\n  const {\n    zoomInMultiplier\n  } = useZoomProps();\n  const currentSource = currentSlide && isImageSlide(currentSlide) ? currentSlide.src : undefined;\n  const disabled = !currentSource || !(zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current);\n  useLayoutEffect(() => {\n    setZoom(1);\n    setOffsetX(0);\n    setOffsetY(0);\n  }, [globalIndex, currentSource]);\n  const changeOffsets = React.useCallback((dx, dy, targetZoom) => {\n    const newZoom = targetZoom || zoom;\n    const newOffsetX = offsetX - (dx || 0);\n    const newOffsetY = offsetY - (dy || 0);\n    const maxOffsetX = (imageRect.width * newZoom - slideRect.width) / 2 / newZoom;\n    const maxOffsetY = (imageRect.height * newZoom - slideRect.height) / 2 / newZoom;\n    setOffsetX(Math.min(Math.abs(newOffsetX), Math.max(maxOffsetX, 0)) * Math.sign(newOffsetX));\n    setOffsetY(Math.min(Math.abs(newOffsetY), Math.max(maxOffsetY, 0)) * Math.sign(newOffsetY));\n  }, [zoom, offsetX, offsetY, slideRect, imageRect.width, imageRect.height]);\n  const changeZoom = React.useCallback((targetZoom, rapid, dx, dy) => {\n    const newZoom = round(Math.min(Math.max(targetZoom + 0.001 < maxZoom ? targetZoom : maxZoom, 1), maxZoom), 5);\n    if (newZoom === zoom) return;\n    if (!rapid) {\n      animate();\n    }\n    changeOffsets(dx ? dx * (1 / zoom - 1 / newZoom) : 0, dy ? dy * (1 / zoom - 1 / newZoom) : 0, newZoom);\n    setZoom(newZoom);\n  }, [zoom, maxZoom, changeOffsets, animate]);\n  const handleControllerRectChange = useEventCallback(() => {\n    if (zoom > 1) {\n      if (zoom > maxZoom) {\n        changeZoom(maxZoom, true);\n      }\n      changeOffsets();\n    }\n  });\n  useLayoutEffect(handleControllerRectChange, [containerRect.width, containerRect.height, handleControllerRectChange]);\n  const zoomIn = React.useCallback(() => changeZoom(zoom * zoomInMultiplier), [zoom, zoomInMultiplier, changeZoom]);\n  const zoomOut = React.useCallback(() => changeZoom(zoom / zoomInMultiplier), [zoom, zoomInMultiplier, changeZoom]);\n  return {\n    zoom,\n    offsetX,\n    offsetY,\n    disabled,\n    changeOffsets,\n    changeZoom,\n    zoomIn,\n    zoomOut\n  };\n}\nconst ZoomControllerContext = React.createContext(null);\nconst useZoom = makeUseContext(\"useZoom\", \"ZoomControllerContext\", ZoomControllerContext);\nfunction ZoomContextProvider(_ref) {\n  let {\n    children\n  } = _ref;\n  const [zoomWrapper, setZoomWrapper] = React.useState();\n  const {\n    slideRect\n  } = useController();\n  const {\n    imageRect,\n    maxZoom\n  } = useZoomImageRect(slideRect, zoomWrapper === null || zoomWrapper === void 0 ? void 0 : zoomWrapper.imageDimensions);\n  const {\n    zoom,\n    offsetX,\n    offsetY,\n    disabled,\n    changeZoom,\n    changeOffsets,\n    zoomIn,\n    zoomOut\n  } = useZoomState(imageRect, maxZoom, zoomWrapper === null || zoomWrapper === void 0 ? void 0 : zoomWrapper.zoomWrapperRef);\n  useZoomCallback(zoom, disabled);\n  useZoomSensors(zoom, maxZoom, disabled, changeZoom, changeOffsets, zoomWrapper === null || zoomWrapper === void 0 ? void 0 : zoomWrapper.zoomWrapperRef);\n  const zoomRef = React.useMemo(() => ({\n    zoom,\n    maxZoom,\n    offsetX,\n    offsetY,\n    disabled,\n    zoomIn,\n    zoomOut,\n    changeZoom\n  }), [zoom, maxZoom, offsetX, offsetY, disabled, zoomIn, zoomOut, changeZoom]);\n  React.useImperativeHandle(useZoomProps().ref, () => zoomRef, [zoomRef]);\n  const context = React.useMemo(() => ({\n    ...zoomRef,\n    setZoomWrapper\n  }), [zoomRef, setZoomWrapper]);\n  return React.createElement(ZoomControllerContext.Provider, {\n    value: context\n  }, children);\n}\nconst ZoomInIcon = createIcon(\"ZoomIn\", React.createElement(React.Fragment, null, React.createElement(\"path\", {\n  d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"\n}), React.createElement(\"path\", {\n  d: \"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\"\n})));\nconst ZoomOutIcon = createIcon(\"ZoomOut\", React.createElement(\"path\", {\n  d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z\"\n}));\nconst ZoomButton = React.forwardRef(function ZoomButton(_ref2, ref) {\n  let {\n    zoomIn,\n    onLoseFocus\n  } = _ref2;\n  const wasEnabled = React.useRef(false);\n  const wasFocused = React.useRef(false);\n  const {\n    zoom,\n    maxZoom,\n    zoomIn: zoomInCallback,\n    zoomOut: zoomOutCallback,\n    disabled: zoomDisabled\n  } = useZoom();\n  const {\n    render\n  } = useLightboxProps();\n  const disabled = zoomDisabled || (zoomIn ? zoom >= maxZoom : zoom <= 1);\n  React.useEffect(() => {\n    if (disabled && wasEnabled.current && wasFocused.current) {\n      onLoseFocus();\n    }\n    if (!disabled) {\n      wasEnabled.current = true;\n    }\n  }, [disabled, onLoseFocus]);\n  return React.createElement(IconButton, {\n    ref: ref,\n    disabled: disabled,\n    label: zoomIn ? \"Zoom in\" : \"Zoom out\",\n    icon: zoomIn ? ZoomInIcon : ZoomOutIcon,\n    renderIcon: zoomIn ? render.iconZoomIn : render.iconZoomOut,\n    onClick: zoomIn ? zoomInCallback : zoomOutCallback,\n    onFocus: () => {\n      wasFocused.current = true;\n    },\n    onBlur: () => {\n      wasFocused.current = false;\n    }\n  });\n});\nfunction ZoomButtonsGroup() {\n  const zoomInRef = React.useRef(null);\n  const zoomOutRef = React.useRef(null);\n  const {\n    focus\n  } = useController();\n  const focusSibling = React.useCallback(sibling => {\n    var _a, _b;\n    if (!((_a = sibling.current) === null || _a === void 0 ? void 0 : _a.disabled)) {\n      (_b = sibling.current) === null || _b === void 0 ? void 0 : _b.focus();\n    } else {\n      focus();\n    }\n  }, [focus]);\n  const focusZoomIn = React.useCallback(() => focusSibling(zoomInRef), [focusSibling]);\n  const focusZoomOut = React.useCallback(() => focusSibling(zoomOutRef), [focusSibling]);\n  return React.createElement(React.Fragment, null, React.createElement(ZoomButton, {\n    zoomIn: true,\n    ref: zoomInRef,\n    onLoseFocus: focusZoomOut\n  }), React.createElement(ZoomButton, {\n    ref: zoomOutRef,\n    onLoseFocus: focusZoomIn\n  }));\n}\nfunction ZoomToolbarControl() {\n  const {\n    render\n  } = useLightboxProps();\n  const zoomRef = useZoom();\n  if (render.buttonZoom) {\n    return React.createElement(React.Fragment, null, render.buttonZoom(zoomRef));\n  }\n  return React.createElement(ZoomButtonsGroup, null);\n}\nfunction isResponsiveImageSlide(slide) {\n  var _a;\n  return (((_a = slide.srcSet) === null || _a === void 0 ? void 0 : _a.length) || 0) > 0;\n}\nfunction reducer(_ref3, _ref4) {\n  let {\n    current,\n    preload\n  } = _ref3;\n  let {\n    type,\n    source\n  } = _ref4;\n  switch (type) {\n    case \"fetch\":\n      if (!current) {\n        return {\n          current: source\n        };\n      }\n      return {\n        current,\n        preload: source\n      };\n    case \"done\":\n      if (source === preload) {\n        return {\n          current: source\n        };\n      }\n      return {\n        current,\n        preload\n      };\n    default:\n      throw new Error(UNKNOWN_ACTION_TYPE);\n  }\n}\nfunction ResponsiveImage(props) {\n  var _a, _b;\n  const [{\n    current,\n    preload\n  }, dispatch] = React.useReducer(reducer, {});\n  const {\n    slide: image,\n    rect,\n    imageFit,\n    render,\n    interactive\n  } = props;\n  const srcSet = image.srcSet.sort((a, b) => a.width - b.width);\n  const width = (_a = image.width) !== null && _a !== void 0 ? _a : srcSet[srcSet.length - 1].width;\n  const height = (_b = image.height) !== null && _b !== void 0 ? _b : srcSet[srcSet.length - 1].height;\n  const cover = isImageFitCover(image, imageFit);\n  const maxWidth = Math.max(...srcSet.map(x => x.width));\n  const targetWidth = Math.min((cover ? Math.max : Math.min)(rect.width, width * (rect.height / height)), maxWidth);\n  const pixelDensity = devicePixelRatio();\n  const handleResize = useEventCallback(() => {\n    var _a;\n    const targetSource = (_a = srcSet.find(x => x.width >= targetWidth * pixelDensity)) !== null && _a !== void 0 ? _a : srcSet[srcSet.length - 1];\n    if (!current || srcSet.findIndex(x => x.src === current) < srcSet.findIndex(x => x === targetSource)) {\n      dispatch({\n        type: \"fetch\",\n        source: targetSource.src\n      });\n    }\n  });\n  useLayoutEffect(handleResize, [rect.width, rect.height, pixelDensity, handleResize]);\n  const handlePreload = useEventCallback(currentPreload => dispatch({\n    type: \"done\",\n    source: currentPreload\n  }));\n  const style = {\n    WebkitTransform: !interactive ? \"translateZ(0)\" : \"initial\"\n  };\n  if (!cover) {\n    Object.assign(style, rect.width / rect.height < width / height ? {\n      width: \"100%\",\n      height: \"auto\"\n    } : {\n      width: \"auto\",\n      height: \"100%\"\n    });\n  }\n  return React.createElement(React.Fragment, null, preload && preload !== current && React.createElement(ImageSlide, {\n    key: \"preload\",\n    ...props,\n    offset: undefined,\n    slide: {\n      ...image,\n      src: preload,\n      srcSet: undefined\n    },\n    style: {\n      position: \"absolute\",\n      visibility: \"hidden\",\n      ...style\n    },\n    onLoad: () => handlePreload(preload),\n    render: {\n      ...render,\n      iconLoading: () => null,\n      iconError: () => null\n    }\n  }), current && React.createElement(ImageSlide, {\n    key: \"current\",\n    ...props,\n    slide: {\n      ...image,\n      src: current,\n      srcSet: undefined\n    },\n    style: style\n  }));\n}\nfunction ZoomWrapper(_ref5) {\n  let {\n    render,\n    slide,\n    offset,\n    rect\n  } = _ref5;\n  var _a;\n  const [imageDimensions, setImageDimensions] = React.useState();\n  const zoomWrapperRef = React.useRef(null);\n  const {\n    zoom,\n    maxZoom,\n    offsetX,\n    offsetY,\n    setZoomWrapper\n  } = useZoom();\n  const interactive = zoom > 1;\n  const {\n    carousel,\n    on\n  } = useLightboxProps();\n  const {\n    currentIndex\n  } = useLightboxState();\n  useLayoutEffect(() => {\n    if (offset === 0) {\n      setZoomWrapper({\n        zoomWrapperRef,\n        imageDimensions\n      });\n      return () => setZoomWrapper(undefined);\n    }\n    return () => {};\n  }, [offset, imageDimensions, setZoomWrapper]);\n  let rendered = (_a = render.slide) === null || _a === void 0 ? void 0 : _a.call(render, {\n    slide,\n    offset,\n    rect,\n    zoom,\n    maxZoom\n  });\n  if (!rendered && isImageSlide(slide)) {\n    const slideProps = {\n      slide,\n      offset,\n      rect,\n      render,\n      imageFit: carousel.imageFit,\n      imageProps: carousel.imageProps,\n      onClick: offset === 0 ? () => {\n        var _a;\n        return (_a = on.click) === null || _a === void 0 ? void 0 : _a.call(on, {\n          index: currentIndex\n        });\n      } : undefined\n    };\n    rendered = isResponsiveImageSlide(slide) ? React.createElement(ResponsiveImage, {\n      ...slideProps,\n      slide: slide,\n      interactive: interactive,\n      rect: offset === 0 ? {\n        width: rect.width * zoom,\n        height: rect.height * zoom\n      } : rect\n    }) : React.createElement(ImageSlide, {\n      onLoad: img => setImageDimensions({\n        width: img.naturalWidth,\n        height: img.naturalHeight\n      }),\n      ...slideProps\n    });\n  }\n  if (!rendered) return null;\n  return React.createElement(\"div\", {\n    ref: zoomWrapperRef,\n    className: clsx(cssClass(CLASS_FULLSIZE), cssClass(CLASS_FLEX_CENTER), cssClass(CLASS_SLIDE_WRAPPER), interactive && cssClass(CLASS_SLIDE_WRAPPER_INTERACTIVE)),\n    style: offset === 0 ? {\n      transform: `scale(${zoom}) translateX(${offsetX}px) translateY(${offsetY}px)`\n    } : undefined\n  }, rendered);\n}\nconst Zoom = _ref6 => {\n  let {\n    augment,\n    addModule\n  } = _ref6;\n  augment(_ref7 => {\n    let {\n      zoom: zoomProps,\n      toolbar,\n      render,\n      controller,\n      ...restProps\n    } = _ref7;\n    const zoom = resolveZoomProps(zoomProps);\n    return {\n      zoom,\n      toolbar: addToolbarButton(toolbar, PLUGIN_ZOOM, React.createElement(ZoomToolbarControl, null)),\n      render: {\n        ...render,\n        slide: props => {\n          var _a;\n          return isImageSlide(props.slide) ? React.createElement(ZoomWrapper, {\n            render: render,\n            ...props\n          }) : (_a = render.slide) === null || _a === void 0 ? void 0 : _a.call(render, props);\n        }\n      },\n      controller: {\n        ...controller,\n        preventDefaultWheelY: zoom.scrollToZoom\n      },\n      ...restProps\n    };\n  });\n  addModule(createModule(PLUGIN_ZOOM, ZoomContextProvider));\n};\nexport { Zoom as default };","map":{"version":3,"names":["React","useLightboxProps","useMotionPreference","useEventCallback","useLayoutEffect","useLightboxState","isImageSlide","isImageFitCover","round","useDocumentContext","useController","usePointerEvents","cleanup","makeUseContext","createIcon","IconButton","devicePixelRatio","ImageSlide","clsx","cssClass","addToolbarButton","createModule","EVENT_ON_KEY_DOWN","EVENT_ON_WHEEL","UNKNOWN_ACTION_TYPE","CLASS_FULLSIZE","CLASS_FLEX_CENTER","CLASS_SLIDE_WRAPPER","CLASS_SLIDE_WRAPPER_INTERACTIVE","PLUGIN_ZOOM","defaultZoomProps","maxZoomPixelRatio","zoomInMultiplier","doubleTapDelay","doubleClickDelay","doubleClickMaxStops","keyboardMoveDistance","wheelZoomDistanceFactor","pinchZoomDistanceFactor","scrollToZoom","resolveZoomProps","zoom","useZoomAnimation","offsetX","offsetY","zoomWrapperRef","zoomAnimation","useRef","undefined","zoomAnimationStart","zoomAnimationDuration","animation","reduceMotion","playZoomAnimation","_a","_b","_c","current","cancel","animate","call","transform","duration","easing","err","console","error","onfinish","useCallback","window","getComputedStyle","useZoomCallback","disabled","on","onZoomCallback","useEffect","useZoomProps","useZoomImageRect","slideRect","imageDimensions","imageRect","width","height","maxImageRect","currentSlide","imageFit","carousel","slide","cover","Math","max","srcSet","map","x","concat","min","maxZoom","distance","pointerA","pointerB","clientX","clientY","scaleZoom","value","delta","factor","arguments","length","clamp","abs","sign","useZoomSensors","changeZoom","changeOffsets","activePointers","lastPointerDown","pinchZoomDistance","globalIndex","getOwnerWindow","containerRef","subscribeSensors","translateCoordinates","event","pageX","pageY","scrollX","scrollY","left","top","getBoundingClientRect","onKeyDown","key","metaKey","ctrlKey","meta","preventDefault","stopPropagation","move","deltaX","deltaY","handleChangeZoom","zoomValue","onWheel","clearPointer","pointers","splice","filter","p","pointerId","replacePointer","persist","push","onPointerDown","pointerType","buttons","contains","target","timeStamp","onPointerMove","activePointer","find","currentDistance","reduce","acc","coordinate","i","onPointerUp","cleanupSensors","useZoomState","setZoom","useState","setOffsetX","setOffsetY","containerRect","currentSource","src","dx","dy","targetZoom","newZoom","newOffsetX","newOffsetY","maxOffsetX","maxOffsetY","rapid","handleControllerRectChange","zoomIn","zoomOut","ZoomControllerContext","createContext","useZoom","ZoomContextProvider","_ref","children","zoomWrapper","setZoomWrapper","zoomRef","useMemo","useImperativeHandle","ref","context","createElement","Provider","ZoomInIcon","Fragment","d","ZoomOutIcon","ZoomButton","forwardRef","_ref2","onLoseFocus","wasEnabled","wasFocused","zoomInCallback","zoomOutCallback","zoomDisabled","render","label","icon","renderIcon","iconZoomIn","iconZoomOut","onClick","onFocus","onBlur","ZoomButtonsGroup","zoomInRef","zoomOutRef","focus","focusSibling","sibling","focusZoomIn","focusZoomOut","ZoomToolbarControl","buttonZoom","isResponsiveImageSlide","reducer","_ref3","_ref4","preload","type","source","Error","ResponsiveImage","props","dispatch","useReducer","image","rect","interactive","sort","a","b","maxWidth","targetWidth","pixelDensity","handleResize","targetSource","findIndex","handlePreload","currentPreload","style","WebkitTransform","Object","assign","offset","position","visibility","onLoad","iconLoading","iconError","ZoomWrapper","_ref5","setImageDimensions","currentIndex","rendered","slideProps","imageProps","click","index","img","naturalWidth","naturalHeight","className","Zoom","_ref6","augment","addModule","_ref7","zoomProps","toolbar","controller","restProps","preventDefaultWheelY","default"],"sources":["/home/reece_crook/Development/Masterbilt-Projects/palomino-townhomes/node_modules/yet-another-react-lightbox/dist/plugins/zoom/index.js"],"sourcesContent":["import * as React from 'react';\nimport { useLightboxProps, useMotionPreference, useEventCallback, useLayoutEffect, useLightboxState, isImageSlide, isImageFitCover, round, useDocumentContext, useController, usePointerEvents, cleanup, makeUseContext, createIcon, IconButton, devicePixelRatio, ImageSlide, clsx, cssClass, addToolbarButton, createModule } from '../../index.js';\nimport { EVENT_ON_KEY_DOWN, EVENT_ON_WHEEL, UNKNOWN_ACTION_TYPE, CLASS_FULLSIZE, CLASS_FLEX_CENTER, CLASS_SLIDE_WRAPPER, CLASS_SLIDE_WRAPPER_INTERACTIVE, PLUGIN_ZOOM } from '../../types.js';\n\nconst defaultZoomProps = {\n    maxZoomPixelRatio: 1,\n    zoomInMultiplier: 2,\n    doubleTapDelay: 300,\n    doubleClickDelay: 500,\n    doubleClickMaxStops: 2,\n    keyboardMoveDistance: 50,\n    wheelZoomDistanceFactor: 100,\n    pinchZoomDistanceFactor: 100,\n    scrollToZoom: false,\n};\nconst resolveZoomProps = (zoom) => ({\n    ...defaultZoomProps,\n    ...zoom,\n});\n\nfunction useZoomAnimation(zoom, offsetX, offsetY, zoomWrapperRef) {\n    const zoomAnimation = React.useRef(undefined);\n    const zoomAnimationStart = React.useRef(undefined);\n    const { zoom: zoomAnimationDuration } = useLightboxProps().animation;\n    const reduceMotion = useMotionPreference();\n    const playZoomAnimation = useEventCallback(() => {\n        var _a, _b, _c;\n        (_a = zoomAnimation.current) === null || _a === void 0 ? void 0 : _a.cancel();\n        zoomAnimation.current = undefined;\n        if (zoomAnimationStart.current && (zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current)) {\n            try {\n                zoomAnimation.current = (_c = (_b = zoomWrapperRef.current).animate) === null || _c === void 0 ? void 0 : _c.call(_b, [\n                    { transform: zoomAnimationStart.current },\n                    { transform: `scale(${zoom}) translateX(${offsetX}px) translateY(${offsetY}px)` },\n                ], {\n                    duration: !reduceMotion ? (zoomAnimationDuration !== null && zoomAnimationDuration !== void 0 ? zoomAnimationDuration : 500) : 0,\n                    easing: zoomAnimation.current ? \"ease-out\" : \"ease-in-out\",\n                });\n            }\n            catch (err) {\n                console.error(err);\n            }\n            zoomAnimationStart.current = undefined;\n            if (zoomAnimation.current) {\n                zoomAnimation.current.onfinish = () => {\n                    zoomAnimation.current = undefined;\n                };\n            }\n        }\n    });\n    useLayoutEffect(playZoomAnimation, [zoom, offsetX, offsetY, playZoomAnimation]);\n    return React.useCallback(() => {\n        zoomAnimationStart.current = (zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current)\n            ? window.getComputedStyle(zoomWrapperRef.current).transform\n            : undefined;\n    }, [zoomWrapperRef]);\n}\n\nfunction useZoomCallback(zoom, disabled) {\n    const { on } = useLightboxProps();\n    const onZoomCallback = useEventCallback(() => {\n        var _a;\n        if (!disabled) {\n            (_a = on.zoom) === null || _a === void 0 ? void 0 : _a.call(on, { zoom });\n        }\n    });\n    React.useEffect(onZoomCallback, [zoom, onZoomCallback]);\n}\n\nfunction useZoomProps() {\n    const { zoom } = useLightboxProps();\n    return resolveZoomProps(zoom);\n}\n\nfunction useZoomImageRect(slideRect, imageDimensions) {\n    var _a, _b;\n    let imageRect = { width: 0, height: 0 };\n    let maxImageRect = { width: 0, height: 0 };\n    const { currentSlide } = useLightboxState();\n    const { imageFit } = useLightboxProps().carousel;\n    const { maxZoomPixelRatio } = useZoomProps();\n    if (slideRect && currentSlide) {\n        const slide = { ...currentSlide, ...imageDimensions };\n        if (isImageSlide(slide)) {\n            const cover = isImageFitCover(slide, imageFit);\n            const width = Math.max(...(((_a = slide.srcSet) === null || _a === void 0 ? void 0 : _a.map((x) => x.width)) || []).concat(slide.width ? [slide.width] : []));\n            const height = Math.max(...(((_b = slide.srcSet) === null || _b === void 0 ? void 0 : _b.map((x) => x.height)) || []).concat(slide.height ? [slide.height] : []));\n            if (width > 0 && height > 0 && slideRect.width > 0 && slideRect.height > 0) {\n                maxImageRect = cover\n                    ? {\n                        width: Math.round(Math.min(width, (slideRect.width / slideRect.height) * height)),\n                        height: Math.round(Math.min(height, (slideRect.height / slideRect.width) * width)),\n                    }\n                    : { width, height };\n                maxImageRect = {\n                    width: maxImageRect.width * maxZoomPixelRatio,\n                    height: maxImageRect.height * maxZoomPixelRatio,\n                };\n                imageRect = cover\n                    ? {\n                        width: Math.min(slideRect.width, maxImageRect.width, width),\n                        height: Math.min(slideRect.height, maxImageRect.height, height),\n                    }\n                    : {\n                        width: Math.round(Math.min(slideRect.width, (slideRect.height / height) * width, width)),\n                        height: Math.round(Math.min(slideRect.height, (slideRect.width / width) * height, height)),\n                    };\n            }\n        }\n    }\n    const maxZoom = imageRect.width ? Math.max(round(maxImageRect.width / imageRect.width, 5), 1) : 1;\n    return { imageRect, maxZoom };\n}\n\nfunction distance(pointerA, pointerB) {\n    return ((pointerA.clientX - pointerB.clientX) ** 2 + (pointerA.clientY - pointerB.clientY) ** 2) ** 0.5;\n}\nfunction scaleZoom(value, delta, factor = 100, clamp = 2) {\n    return value * Math.min(1 + Math.abs(delta / factor), clamp) ** Math.sign(delta);\n}\nfunction useZoomSensors(zoom, maxZoom, disabled, changeZoom, changeOffsets, zoomWrapperRef) {\n    const activePointers = React.useRef([]);\n    const lastPointerDown = React.useRef(0);\n    const pinchZoomDistance = React.useRef(undefined);\n    const { globalIndex } = useLightboxState();\n    const { getOwnerWindow } = useDocumentContext();\n    const { containerRef, subscribeSensors } = useController();\n    const { keyboardMoveDistance, zoomInMultiplier, wheelZoomDistanceFactor, scrollToZoom, doubleTapDelay, doubleClickDelay, doubleClickMaxStops, pinchZoomDistanceFactor, } = useZoomProps();\n    const translateCoordinates = React.useCallback((event) => {\n        if (containerRef.current) {\n            const { pageX, pageY } = event;\n            const { scrollX, scrollY } = getOwnerWindow();\n            const { left, top, width, height } = containerRef.current.getBoundingClientRect();\n            return [pageX - left - scrollX - width / 2, pageY - top - scrollY - height / 2];\n        }\n        return [];\n    }, [containerRef, getOwnerWindow]);\n    const onKeyDown = useEventCallback((event) => {\n        const { key, metaKey, ctrlKey } = event;\n        const meta = metaKey || ctrlKey;\n        const preventDefault = () => {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n        if (zoom > 1) {\n            const move = (deltaX, deltaY) => {\n                preventDefault();\n                changeOffsets(deltaX, deltaY);\n            };\n            if (key === \"ArrowDown\") {\n                move(0, keyboardMoveDistance);\n            }\n            else if (key === \"ArrowUp\") {\n                move(0, -keyboardMoveDistance);\n            }\n            else if (key === \"ArrowLeft\") {\n                move(-keyboardMoveDistance, 0);\n            }\n            else if (key === \"ArrowRight\") {\n                move(keyboardMoveDistance, 0);\n            }\n        }\n        const handleChangeZoom = (zoomValue) => {\n            preventDefault();\n            changeZoom(zoomValue);\n        };\n        if (key === \"+\" || (meta && key === \"=\")) {\n            handleChangeZoom(zoom * zoomInMultiplier);\n        }\n        else if (key === \"-\" || (meta && key === \"_\")) {\n            handleChangeZoom(zoom / zoomInMultiplier);\n        }\n        else if (meta && key === \"0\") {\n            handleChangeZoom(1);\n        }\n    });\n    const onWheel = useEventCallback((event) => {\n        if (event.ctrlKey || scrollToZoom) {\n            if (Math.abs(event.deltaY) > Math.abs(event.deltaX)) {\n                event.stopPropagation();\n                changeZoom(scaleZoom(zoom, -event.deltaY, wheelZoomDistanceFactor), true, ...translateCoordinates(event));\n                return;\n            }\n        }\n        if (zoom > 1) {\n            event.stopPropagation();\n            if (!scrollToZoom) {\n                changeOffsets(event.deltaX, event.deltaY);\n            }\n        }\n    });\n    const clearPointer = React.useCallback((event) => {\n        const pointers = activePointers.current;\n        pointers.splice(0, pointers.length, ...pointers.filter((p) => p.pointerId !== event.pointerId));\n    }, []);\n    const replacePointer = React.useCallback((event) => {\n        clearPointer(event);\n        event.persist();\n        activePointers.current.push(event);\n    }, [clearPointer]);\n    const onPointerDown = useEventCallback((event) => {\n        var _a;\n        const pointers = activePointers.current;\n        if ((event.pointerType === \"mouse\" && event.buttons > 1) ||\n            !((_a = zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target))) {\n            return;\n        }\n        if (zoom > 1) {\n            event.stopPropagation();\n        }\n        const { timeStamp } = event;\n        if (pointers.length === 0 &&\n            timeStamp - lastPointerDown.current < (event.pointerType === \"touch\" ? doubleTapDelay : doubleClickDelay)) {\n            lastPointerDown.current = 0;\n            changeZoom(zoom !== maxZoom ? zoom * Math.max(maxZoom ** (1 / doubleClickMaxStops), zoomInMultiplier) : 1, false, ...translateCoordinates(event));\n        }\n        else {\n            lastPointerDown.current = timeStamp;\n        }\n        replacePointer(event);\n        if (pointers.length === 2) {\n            pinchZoomDistance.current = distance(pointers[0], pointers[1]);\n        }\n    });\n    const onPointerMove = useEventCallback((event) => {\n        const pointers = activePointers.current;\n        const activePointer = pointers.find((p) => p.pointerId === event.pointerId);\n        if (pointers.length === 2 && pinchZoomDistance.current) {\n            event.stopPropagation();\n            replacePointer(event);\n            const currentDistance = distance(pointers[0], pointers[1]);\n            const delta = currentDistance - pinchZoomDistance.current;\n            if (Math.abs(delta) > 0) {\n                changeZoom(scaleZoom(zoom, delta, pinchZoomDistanceFactor), true, ...pointers\n                    .map((x) => translateCoordinates(x))\n                    .reduce((acc, coordinate) => coordinate.map((x, i) => acc[i] + x / 2)));\n                pinchZoomDistance.current = currentDistance;\n            }\n            return;\n        }\n        if (zoom > 1) {\n            event.stopPropagation();\n            if (activePointer) {\n                if (pointers.length === 1) {\n                    changeOffsets((activePointer.clientX - event.clientX) / zoom, (activePointer.clientY - event.clientY) / zoom);\n                }\n                replacePointer(event);\n            }\n        }\n    });\n    const onPointerUp = React.useCallback((event) => {\n        const pointers = activePointers.current;\n        if (pointers.length === 2 && pointers.find((p) => p.pointerId === event.pointerId)) {\n            pinchZoomDistance.current = undefined;\n        }\n        clearPointer(event);\n    }, [clearPointer]);\n    const cleanupSensors = React.useCallback(() => {\n        const pointers = activePointers.current;\n        pointers.splice(0, pointers.length);\n        lastPointerDown.current = 0;\n        pinchZoomDistance.current = undefined;\n    }, []);\n    usePointerEvents(subscribeSensors, onPointerDown, onPointerMove, onPointerUp, disabled);\n    React.useEffect(cleanupSensors, [globalIndex, cleanupSensors]);\n    React.useEffect(() => {\n        if (!disabled) {\n            return cleanup(cleanupSensors, subscribeSensors(EVENT_ON_KEY_DOWN, onKeyDown), subscribeSensors(EVENT_ON_WHEEL, onWheel));\n        }\n        return () => { };\n    }, [disabled, subscribeSensors, cleanupSensors, onKeyDown, onWheel]);\n}\n\nfunction useZoomState(imageRect, maxZoom, zoomWrapperRef) {\n    const [zoom, setZoom] = React.useState(1);\n    const [offsetX, setOffsetX] = React.useState(0);\n    const [offsetY, setOffsetY] = React.useState(0);\n    const animate = useZoomAnimation(zoom, offsetX, offsetY, zoomWrapperRef);\n    const { currentSlide, globalIndex } = useLightboxState();\n    const { containerRect, slideRect } = useController();\n    const { zoomInMultiplier } = useZoomProps();\n    const currentSource = currentSlide && isImageSlide(currentSlide) ? currentSlide.src : undefined;\n    const disabled = !currentSource || !(zoomWrapperRef === null || zoomWrapperRef === void 0 ? void 0 : zoomWrapperRef.current);\n    useLayoutEffect(() => {\n        setZoom(1);\n        setOffsetX(0);\n        setOffsetY(0);\n    }, [globalIndex, currentSource]);\n    const changeOffsets = React.useCallback((dx, dy, targetZoom) => {\n        const newZoom = targetZoom || zoom;\n        const newOffsetX = offsetX - (dx || 0);\n        const newOffsetY = offsetY - (dy || 0);\n        const maxOffsetX = (imageRect.width * newZoom - slideRect.width) / 2 / newZoom;\n        const maxOffsetY = (imageRect.height * newZoom - slideRect.height) / 2 / newZoom;\n        setOffsetX(Math.min(Math.abs(newOffsetX), Math.max(maxOffsetX, 0)) * Math.sign(newOffsetX));\n        setOffsetY(Math.min(Math.abs(newOffsetY), Math.max(maxOffsetY, 0)) * Math.sign(newOffsetY));\n    }, [zoom, offsetX, offsetY, slideRect, imageRect.width, imageRect.height]);\n    const changeZoom = React.useCallback((targetZoom, rapid, dx, dy) => {\n        const newZoom = round(Math.min(Math.max(targetZoom + 0.001 < maxZoom ? targetZoom : maxZoom, 1), maxZoom), 5);\n        if (newZoom === zoom)\n            return;\n        if (!rapid) {\n            animate();\n        }\n        changeOffsets(dx ? dx * (1 / zoom - 1 / newZoom) : 0, dy ? dy * (1 / zoom - 1 / newZoom) : 0, newZoom);\n        setZoom(newZoom);\n    }, [zoom, maxZoom, changeOffsets, animate]);\n    const handleControllerRectChange = useEventCallback(() => {\n        if (zoom > 1) {\n            if (zoom > maxZoom) {\n                changeZoom(maxZoom, true);\n            }\n            changeOffsets();\n        }\n    });\n    useLayoutEffect(handleControllerRectChange, [containerRect.width, containerRect.height, handleControllerRectChange]);\n    const zoomIn = React.useCallback(() => changeZoom(zoom * zoomInMultiplier), [zoom, zoomInMultiplier, changeZoom]);\n    const zoomOut = React.useCallback(() => changeZoom(zoom / zoomInMultiplier), [zoom, zoomInMultiplier, changeZoom]);\n    return { zoom, offsetX, offsetY, disabled, changeOffsets, changeZoom, zoomIn, zoomOut };\n}\n\nconst ZoomControllerContext = React.createContext(null);\nconst useZoom = makeUseContext(\"useZoom\", \"ZoomControllerContext\", ZoomControllerContext);\nfunction ZoomContextProvider({ children }) {\n    const [zoomWrapper, setZoomWrapper] = React.useState();\n    const { slideRect } = useController();\n    const { imageRect, maxZoom } = useZoomImageRect(slideRect, zoomWrapper === null || zoomWrapper === void 0 ? void 0 : zoomWrapper.imageDimensions);\n    const { zoom, offsetX, offsetY, disabled, changeZoom, changeOffsets, zoomIn, zoomOut } = useZoomState(imageRect, maxZoom, zoomWrapper === null || zoomWrapper === void 0 ? void 0 : zoomWrapper.zoomWrapperRef);\n    useZoomCallback(zoom, disabled);\n    useZoomSensors(zoom, maxZoom, disabled, changeZoom, changeOffsets, zoomWrapper === null || zoomWrapper === void 0 ? void 0 : zoomWrapper.zoomWrapperRef);\n    const zoomRef = React.useMemo(() => ({ zoom, maxZoom, offsetX, offsetY, disabled, zoomIn, zoomOut, changeZoom }), [zoom, maxZoom, offsetX, offsetY, disabled, zoomIn, zoomOut, changeZoom]);\n    React.useImperativeHandle(useZoomProps().ref, () => zoomRef, [zoomRef]);\n    const context = React.useMemo(() => ({ ...zoomRef, setZoomWrapper }), [zoomRef, setZoomWrapper]);\n    return React.createElement(ZoomControllerContext.Provider, { value: context }, children);\n}\n\nconst ZoomInIcon = createIcon(\"ZoomIn\", React.createElement(React.Fragment, null,\n    React.createElement(\"path\", { d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\" }),\n    React.createElement(\"path\", { d: \"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\" })));\nconst ZoomOutIcon = createIcon(\"ZoomOut\", React.createElement(\"path\", { d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z\" }));\nconst ZoomButton = React.forwardRef(function ZoomButton({ zoomIn, onLoseFocus }, ref) {\n    const wasEnabled = React.useRef(false);\n    const wasFocused = React.useRef(false);\n    const { zoom, maxZoom, zoomIn: zoomInCallback, zoomOut: zoomOutCallback, disabled: zoomDisabled } = useZoom();\n    const { render } = useLightboxProps();\n    const disabled = zoomDisabled || (zoomIn ? zoom >= maxZoom : zoom <= 1);\n    React.useEffect(() => {\n        if (disabled && wasEnabled.current && wasFocused.current) {\n            onLoseFocus();\n        }\n        if (!disabled) {\n            wasEnabled.current = true;\n        }\n    }, [disabled, onLoseFocus]);\n    return (React.createElement(IconButton, { ref: ref, disabled: disabled, label: zoomIn ? \"Zoom in\" : \"Zoom out\", icon: zoomIn ? ZoomInIcon : ZoomOutIcon, renderIcon: zoomIn ? render.iconZoomIn : render.iconZoomOut, onClick: zoomIn ? zoomInCallback : zoomOutCallback, onFocus: () => {\n            wasFocused.current = true;\n        }, onBlur: () => {\n            wasFocused.current = false;\n        } }));\n});\n\nfunction ZoomButtonsGroup() {\n    const zoomInRef = React.useRef(null);\n    const zoomOutRef = React.useRef(null);\n    const { focus } = useController();\n    const focusSibling = React.useCallback((sibling) => {\n        var _a, _b;\n        if (!((_a = sibling.current) === null || _a === void 0 ? void 0 : _a.disabled)) {\n            (_b = sibling.current) === null || _b === void 0 ? void 0 : _b.focus();\n        }\n        else {\n            focus();\n        }\n    }, [focus]);\n    const focusZoomIn = React.useCallback(() => focusSibling(zoomInRef), [focusSibling]);\n    const focusZoomOut = React.useCallback(() => focusSibling(zoomOutRef), [focusSibling]);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(ZoomButton, { zoomIn: true, ref: zoomInRef, onLoseFocus: focusZoomOut }),\n        React.createElement(ZoomButton, { ref: zoomOutRef, onLoseFocus: focusZoomIn })));\n}\n\nfunction ZoomToolbarControl() {\n    const { render } = useLightboxProps();\n    const zoomRef = useZoom();\n    if (render.buttonZoom) {\n        return React.createElement(React.Fragment, null, render.buttonZoom(zoomRef));\n    }\n    return React.createElement(ZoomButtonsGroup, null);\n}\n\nfunction isResponsiveImageSlide(slide) {\n    var _a;\n    return (((_a = slide.srcSet) === null || _a === void 0 ? void 0 : _a.length) || 0) > 0;\n}\nfunction reducer({ current, preload }, { type, source }) {\n    switch (type) {\n        case \"fetch\":\n            if (!current) {\n                return { current: source };\n            }\n            return { current, preload: source };\n        case \"done\":\n            if (source === preload) {\n                return { current: source };\n            }\n            return { current, preload };\n        default:\n            throw new Error(UNKNOWN_ACTION_TYPE);\n    }\n}\nfunction ResponsiveImage(props) {\n    var _a, _b;\n    const [{ current, preload }, dispatch] = React.useReducer(reducer, {});\n    const { slide: image, rect, imageFit, render, interactive } = props;\n    const srcSet = image.srcSet.sort((a, b) => a.width - b.width);\n    const width = (_a = image.width) !== null && _a !== void 0 ? _a : srcSet[srcSet.length - 1].width;\n    const height = (_b = image.height) !== null && _b !== void 0 ? _b : srcSet[srcSet.length - 1].height;\n    const cover = isImageFitCover(image, imageFit);\n    const maxWidth = Math.max(...srcSet.map((x) => x.width));\n    const targetWidth = Math.min((cover ? Math.max : Math.min)(rect.width, width * (rect.height / height)), maxWidth);\n    const pixelDensity = devicePixelRatio();\n    const handleResize = useEventCallback(() => {\n        var _a;\n        const targetSource = (_a = srcSet.find((x) => x.width >= targetWidth * pixelDensity)) !== null && _a !== void 0 ? _a : srcSet[srcSet.length - 1];\n        if (!current || srcSet.findIndex((x) => x.src === current) < srcSet.findIndex((x) => x === targetSource)) {\n            dispatch({ type: \"fetch\", source: targetSource.src });\n        }\n    });\n    useLayoutEffect(handleResize, [rect.width, rect.height, pixelDensity, handleResize]);\n    const handlePreload = useEventCallback((currentPreload) => dispatch({ type: \"done\", source: currentPreload }));\n    const style = {\n        WebkitTransform: !interactive ? \"translateZ(0)\" : \"initial\",\n    };\n    if (!cover) {\n        Object.assign(style, rect.width / rect.height < width / height ? { width: \"100%\", height: \"auto\" } : { width: \"auto\", height: \"100%\" });\n    }\n    return (React.createElement(React.Fragment, null,\n        preload && preload !== current && (React.createElement(ImageSlide, { key: \"preload\", ...props, offset: undefined, slide: { ...image, src: preload, srcSet: undefined }, style: { position: \"absolute\", visibility: \"hidden\", ...style }, onLoad: () => handlePreload(preload), render: {\n                ...render,\n                iconLoading: () => null,\n                iconError: () => null,\n            } })),\n        current && (React.createElement(ImageSlide, { key: \"current\", ...props, slide: { ...image, src: current, srcSet: undefined }, style: style }))));\n}\n\nfunction ZoomWrapper({ render, slide, offset, rect }) {\n    var _a;\n    const [imageDimensions, setImageDimensions] = React.useState();\n    const zoomWrapperRef = React.useRef(null);\n    const { zoom, maxZoom, offsetX, offsetY, setZoomWrapper } = useZoom();\n    const interactive = zoom > 1;\n    const { carousel, on } = useLightboxProps();\n    const { currentIndex } = useLightboxState();\n    useLayoutEffect(() => {\n        if (offset === 0) {\n            setZoomWrapper({ zoomWrapperRef, imageDimensions });\n            return () => setZoomWrapper(undefined);\n        }\n        return () => { };\n    }, [offset, imageDimensions, setZoomWrapper]);\n    let rendered = (_a = render.slide) === null || _a === void 0 ? void 0 : _a.call(render, { slide, offset, rect, zoom, maxZoom });\n    if (!rendered && isImageSlide(slide)) {\n        const slideProps = {\n            slide,\n            offset,\n            rect,\n            render,\n            imageFit: carousel.imageFit,\n            imageProps: carousel.imageProps,\n            onClick: offset === 0 ? () => { var _a; return (_a = on.click) === null || _a === void 0 ? void 0 : _a.call(on, { index: currentIndex }); } : undefined,\n        };\n        rendered = isResponsiveImageSlide(slide) ? (React.createElement(ResponsiveImage, { ...slideProps, slide: slide, interactive: interactive, rect: offset === 0 ? { width: rect.width * zoom, height: rect.height * zoom } : rect })) : (React.createElement(ImageSlide, { onLoad: (img) => setImageDimensions({ width: img.naturalWidth, height: img.naturalHeight }), ...slideProps }));\n    }\n    if (!rendered)\n        return null;\n    return (React.createElement(\"div\", { ref: zoomWrapperRef, className: clsx(cssClass(CLASS_FULLSIZE), cssClass(CLASS_FLEX_CENTER), cssClass(CLASS_SLIDE_WRAPPER), interactive && cssClass(CLASS_SLIDE_WRAPPER_INTERACTIVE)), style: offset === 0 ? { transform: `scale(${zoom}) translateX(${offsetX}px) translateY(${offsetY}px)` } : undefined }, rendered));\n}\n\nconst Zoom = ({ augment, addModule }) => {\n    augment(({ zoom: zoomProps, toolbar, render, controller, ...restProps }) => {\n        const zoom = resolveZoomProps(zoomProps);\n        return {\n            zoom,\n            toolbar: addToolbarButton(toolbar, PLUGIN_ZOOM, React.createElement(ZoomToolbarControl, null)),\n            render: {\n                ...render,\n                slide: (props) => { var _a; return isImageSlide(props.slide) ? React.createElement(ZoomWrapper, { render: render, ...props }) : (_a = render.slide) === null || _a === void 0 ? void 0 : _a.call(render, props); },\n            },\n            controller: { ...controller, preventDefaultWheelY: zoom.scrollToZoom },\n            ...restProps,\n        };\n    });\n    addModule(createModule(PLUGIN_ZOOM, ZoomContextProvider));\n};\n\nexport { Zoom as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}